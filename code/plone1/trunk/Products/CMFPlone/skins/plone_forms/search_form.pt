<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

    <metal:block fill-slot="base">
        <tal:block tal:define="dummy python:request.set('disable_border', 1)"
                   tal:replace="nothing">
        Disable the tabs
        </tal:block>
    </metal:block>

<div metal:fill-slot="main">

    <h1 i18n:translate="heading_advanced_search">Advanced search for content</h1>
    
    <p i18n:translate="description_advanced_search">
    This search form enables you to find content on the site by
    specifying one or more search terms. 
    <br />
    Remember that you can use the quick search anytime, it's normally
    good enough, this search form is just if you want to be more specific.
    </p>
  
  	<form class="group"
          action="search" 
          method="post" 
          name="search" 
          tal:define="DateTime python:modules['DateTime'].DateTime">

        <span class="legend" i18n:translate="legend_search_terms">Search Terms</span>
			 
        <div class="row">
            <div class="label">
                <span i18n:translate="label_search_text">Search Text</span>
                <div id="text_search_help"
                     i18n:translate="help_search_text" 
                     class="help" 
                     style="visibility:hidden">
                For a simple text search, enter your search term
                here. Multiple words may be found by combining
                them with <strong>AND</strong> and <strong>OR</strong>. 
                The text in this field will be matched with
                items' contents, title and description.
                </div>
            </div>
            
            <div class="field">
                <input type="text" 
                       name="SearchableText" 
                       size="25"
                       tabindex="" 
                       onfocus="formtooltip('text_search_help',1)" 
                       onblur="formtooltip('text_search_help',0)"
                       tal:attributes="tabindex tabindex/next;" 
                       />
            </div>
        </div>

        <div class="row">
            <div class="label">
                <span i18n:translate="label_title">Title</span>
                <div id="title_search_help"
                     i18n:translate="help_search_title" 
                     class="help" 
                     style="visibility:hidden">
                Return items matching this title.
                </div>
            </div>
            
            <div class="field">
                <input type="text" 
                       name="Title" 
                       size="25" 
                       tabindex=""
                       onfocus="formtooltip('title_search_help',1)" 
                       onblur="formtooltip('title_search_help',0)"
                       tal:attributes="tabindex tabindex/next;" 
                       />
            </div>
        </div>

        <div class="row">
            <div class="label">
                <span i18n:translate="label_keywords">Keywords</span>
                <div id="keywords_search_help"
                     i18n:translate="help_search_keywords" 
                     class="help" 
                     style="visibility:hidden">
                Return items matching one or more of these keywords.
                Multiple words may be found
                by pressing <strong>Ctrl</strong> while 
                <strong>left clicking</strong> the keywords.
                </div>
            </div>
            
            <div class="field"
                  tal:define="contentSubjects here/Subject;
                              usedSubjects python:here.portal_catalog.uniqueValuesFor('Subject');">
            
                <select name="Subject:list" 
                        size="7" 
                        multiple="multiple"
                        tabindex=""
                        onfocus="formtooltip('keywords_search_help',1)" 
                        onblur="formtooltip('keywords_search_help',0)"
                        tal:attributes="tabindex tabindex/next;" 
                        >
                    <option value="#"
                            tal:repeat="subject usedSubjects"
                            tal:content="subject"
			    tal:attributes="value subject">dummy</option>
                </select>
                
            </div>
        </div>

        <div class="row">
            <div class="label">
                <span i18n:translate="label_description">Description</span>

                <div id="description_search_help"
                     i18n:translate="help_search_description" 
                     class="help" 
                     style="visibility:hidden">
                Return items matching this description.
                Multiple words may be found
                by combining them with <strong>AND</strong> and <strong>OR</strong>.
                </div>
            </div>
	
            <div class="field">
                <input type="text" 
                       name="Description" 
                       size="25" 
                       tabindex=""
                       onfocus="formtooltip('description_search_help',1)" 
                       onblur="formtooltip('description_search_help',0)"
                       tal:attributes="tabindex tabindex/next;" 
                       />
            </div>
        </div>

        <div class="row">
            <div class="label">
                <span i18n:translate="label_new_items_since">New items since</span>
                <div id="new_items_since_search_help"
                     i18n:translate="help_search_new_items_since" 
                     class="help" 
                     style="visibility:hidden">
                Return items added since you were last logged on, the last week, etc.
                </div>
            </div>
	
            <div class="field">
            
                <span tal:define="today python:DateTime().earliestTime()">
                
                    <select name="created:date"
                            tabindex=""
                            onfocus="formtooltip('new_items_since_search_help',1)" 
                            onblur="formtooltip('new_items_since_search_help',0)"
                            tal:attributes="tabindex tabindex/next;" 
                            tal:define="yesterday python:(today-1).Date();
                                        lastweek python:(today-7).Date();
                                        lastmonth python:(today-31).Date();
                                        ever string:1970/02/01 00:00:00 GMT;">
                        <option value="#"
                                tal:condition="python:test(container.portal_membership.isAnonymousUser(), 0, 1)"
                                tal:attributes="value python:container.portal_membership.getAuthenticatedMember().last_login_time" i18n:translate="last_login">Last log-in</option>
                        <option value="#" tal:attributes="value yesterday" i18n:translate="time_yesterday"> Yesterday </option>
                        <option value="#" tal:attributes="value lastweek" i18n:translate="time_last_week"> Last week </option>
                        <option value="#" tal:attributes="value lastmonth" i18n:translate="time_last_month"> Last month </option>
                        <option value="#" tal:attributes="value ever" selected="selected" i18n:translate="time_ever"> Ever </option>
                    </select>
                
                </span>
                <input type="hidden" name="created_usage" value="range:min" /> 
            </div>
        </div>

        <div class="row">
            <div class="label">
                <span i18n:translate="label_item_type">Item type</span>
                <div id="item_type_search_help"
                     i18n:translate="help_search_item_type" 
                     class="help" 
                     style="visibility:hidden">
                Return items of a specific type.
                </div>
            </div>
            
            <div class="field">
                <span tal:repeat="type python:container.portal_types.listContentTypes()">
                    <metal:block tal:define="tabindex tabindex/next">
                    <input type="checkbox" 
                           name="portal_type:list" 
                           value="#"
                           class="noborder"
                           checked="checked"
                           tabindex=""
                           onfocus="formtooltip('item_type_search_help',1)" 
                           onblur="formtooltip('item_type_search_help',0)" 
                           tal:attributes="value type;
                                           tabindex tabindex;
                                           id string:portal_type_${tabindex}"/> 
                    <label for=""
                           i18n:translate=""
                           tal:attributes="for string:portal_type_${tabindex}"
                           tal:content="python:here.portal_types.getTypeInfo(type).Title()"
                           />
                    <br />
                    </metal:block>
                </span>       
            </div>
        </div>
	
        <div class="row">
            <div class="label">
                <span i18n:translate="label_author">Author</span>
                <div id="author_search_help"
                     i18n:translate="help_search_author" 
                     class="help" 
                     style="visibility:hidden">
                Return items created by a particular person.
                </div>
            </div>
            
            <div class="field" tal:define="creators python:here.portal_catalog.uniqueValuesFor('Creator')"> 
                <select name="Creator"
                        tabindex=""
                        onfocus="formtooltip('author_search_help',1)" 
                        onblur="formtooltip('author_search_help',0)"
                        tal:attributes="tabindex tabindex/next;"> 
                    <option value="" i18n:translate="label_any_author">Any Author</option> 
                    <metal:block tal:repeat="creator creators"> 
                        <option value="" tal:attributes="value creator" tal:content="creator"> username </option> 
                    </metal:block>
                </select> 
            </div>
        </div>

        <div class="row"
             tal:condition="python: container.portal_membership.checkPermission('Review portal content', here)">
        
            <div class="label">
                <span i18n:translate="label_review_status">Review status</span>
                <div id="review_status_search_help"
                     i18n:translate="help_search_review_status" 
                     class="help" 
                     style="visibility:hidden">
                As a reviewer, you may search for items based on their
                review state. If you wish to constrain results to items
                in certain states, select them from this list.
                </div>
            </div>

            <div class="field">
                <span tal:repeat="state python:here.portal_catalog.uniqueValuesFor('review_state')">
                    <metal:block tal:define="tabindex tabindex/next">
                    <input type="checkbox" 
                           name="review_state" 
                           value="#" 
                           checked="checked"
                           class="noborder"
                           tabindex=""
                           onfocus="formtooltip('review_status_search_help',1)" 
                           onblur="formtooltip('review_status_search_help',0)" 
                           tal:attributes="value state;
                                           tabindex tabindex;
                                           id string:review_state_${tabindex}"/> 
                    <label for=""
                           i18n:translate=""
                           tal:content="state"
                           tal:attributes="for string:review_state_${tabindex}" />
                    <br />
                    </metal:block>
                </span> 
            </div>
        </div>

        <div class="row">
            <div class="label">&nbsp;</div>
            <div class="field">
                <input class="context" 
                       tabindex=""
                       type="submit" 
                       name="submit" 
                       value="Search"
                       i18n:attributes="value" 
                       tal:attributes="tabindex tabindex/next;"
                       />
            </div>
        </div>

    </form>
	
</div>
	   
</html>
