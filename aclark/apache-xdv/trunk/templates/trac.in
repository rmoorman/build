WSGIPythonHome ${buildout:directory}/parts/python
<VirtualHost *:${ports:production}>

    ServerAdmin aclark@aclark.net
    ServerName trac-admin.aclark.net

    ErrorLog /srv/apache/var/log/trac_admin-error.log
    CustomLog /srv/apache/var/log/trac_admin-access.log combined

    RedirectMatch ^[/]*$ https://trac-admin.aclark.net

</VirtualHost>

<VirtualHost *:443>

    ServerAdmin aclark@aclark.net
    ServerName trac-admin.aclark.net

    SSLEngine on
    SSLCertificateFile    /etc/ssl/certs/ssl-cert-snakeoil.pem
    SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key

    ErrorLog /srv/apache/var/log/trac_admin_ssl-error.log
    CustomLog /srv/apache/var/log/trac_admin_ssl-access.log combined

    # http://svn.aclark.net/trac/public
    WSGIScriptAlias / /srv/trac-deploy/aclark/cgi-bin/trac.wsgi

    <Directory "/srv/trac-deploy/aclark/cgi-bin">
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
    </Directory>

    <Location />
        AuthType Basic
        AuthName "ACLARK.NET, LLC Trac admin"
        AuthBasicProvider ldap
        AuthzLDAPAuthoritative off
        # ldap://host:port/basedn?attribute?scope?filter
        AuthLDAPUrl ldap://localhost/ou=People,dc=aclark,dc=net?uid
        Require valid-user
    </Location>

</VirtualHost>

