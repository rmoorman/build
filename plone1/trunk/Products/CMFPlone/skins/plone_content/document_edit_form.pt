<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<body>

   <div metal:fill-slot="main" 
        tal:define="rejection here/rejectAnonymous;
                    errors python:request.get('errors', {});
                    editor python:member.getProperty('wysiwyg_editor', 'None');
                    wysiwyg python:test(editor and (editor!='None'), editor, 'None');">

        <h1 i18n:translate="heading_edit_item">
        Edit
            <span i18n:name="itemtype">
                  <span i18n:translate=""         
                        tal:content="python:here.getTypeInfo().Title()" 
                        tal:omit-tag="">Item type</span>
            </span> 
        </h1>
        
        <p i18n:translate="description_edit_document">
        Fill in the details of this document.
        </p>  
    
        <form class="group"
              name="edit_form"
              action="document_edit" 
              method="post" 
              enctype="multipart/form-data"
              tal:attributes="action python:here.portal_form_url(template.id)" >
            <span class="legend" i18n:translate="legend_document_details">Document Details</span>    
          
            <div class="row" 
                 tal:condition="python:member.getProperty('visible_ids', None)"
                 tal:define="error_id errors/id | nothing;
                             id python:request.get('id', test(here.show_id(),here.getId(),''));"> 
                <div class="label">
                
                    <span i18n:translate="label_name">Name</span>
                
                    <div id="id_help" 
                         i18n:translate="help_name"
                         class="help" 
                         style="visibility:hidden">
                    Enter the Name of the document. This is the part that will show up as part
                    of the web address. This should be short, descriptive
                    and preferrably not contain spaces, underscores or mixed case. Example:
                    "expense-report-2002"
                    </div>
                </div>
                
                <div class="field"
                      tal:attributes="class python:test(error_id, 'field error', 'field')" >
    
                    <div tal:replace="error_id" />
    
                    <input type="text" 
                           name="id" 
                           value="#"
                           size="40" 
                           tabindex=""
                           onfocus="formtooltip('id_help',1)" 
                           onblur="formtooltip('id_help',0)"
                           tal:attributes="value id;
                                           tabindex tabindex/next;"
                           />
                </div>
    
            </div>
            <input type="hidden" 
                   name="id" 
                   tal:condition="python: not member.getProperty('visible_ids', None)"
                   tal:attributes="value python:request.get('id', here.getId())" 
                   />
          
            <div class="row"
                 tal:define="error_title errors/title|nothing;
                             Title request/title | here/Title;"> 
                <div class="label required">
                    <span i18n:translate="label_title">Title</span>
                    
                    <div id="title_help" 
                         i18n:translate="help_title"
                         class="help" 
                         style="visibility:hidden">
                    Enter the title of the document.
                    </div>
                </div>
                
                <div class="field"
                      tal:attributes="class python:test(error_title, 'field error', 'field')" >
    
                    <div tal:condition="error_title">
                        <tal:block i18n:translate="" content="error_title">Error</tal:block>
                        <br />
                    </div>
    
                    <input type="text" 
                           name="title" 
                           value="#" 
                           size="40" 
                           tabindex=""
                           tal:attributes="value Title;
                                           tabindex tabindex/next;" 
                           onfocus="formtooltip('title_help',1)" 
                           onblur="formtooltip('title_help',0)" 
                           />
    
                </div>
            </div>
    
            <div class="row">
                <div class="label">
                    <span i18n:translate="label_description">Description</span>
                    
                    <div id="description_help" 
                         i18n:translate="help_description"
                         class="help" 
                         style="visibility:hidden">
                    Enter a brief description of the document. 
                    </div>
                </div>
                <div class="field" tal:define="description request/description | here/Description "> 
                    <textarea cols="80" 
                              rows="5" 
                              tabindex=""
                              name="description"
                              tal:content="description"
                              tal:attributes="tabindex tabindex/next;"
                              onfocus="formtooltip('description_help',1)" 
                              onblur="formtooltip('description_help',0)"
                              >
                    Description 
                    </textarea>
                </div>
            </div>
          
         <div class="row"> 
                <div class="label"> 
                    <span i18n:translate="label_body_text">Body text</span> 
    
                    <div id="body_help" 
                         i18n:translate="help_body_text"
                         class="help" 
                         style="visibility:hidden">
                    The body text of the document. 
                    </div>
                </div>
                <div class="field" tal:define="text python:request.get('text', getattr(here,'text',''));
                                               cooked_text python:request.get('text', getattr(here,'cooked_text',''))">
                    <div tal:define="inputname  string:text; 
                                     formname   string:edit_form;
                                     inputvalue text;
                                     cooked_inputvalue cooked_text;
                                     onfocus string:formtooltip('body_help',1);
                                     onblur string:formtooltip('body_help',0);
                                     tabindex tabindex/next;">
                       <div metal:use-macro="here/wysiwyg_support/macros/wysiwygEditorBox">
                       The WYSIWYG code
                       </div>
                    </div>
                </div>
            </div>

            <div metal:use-macro="here/wysiwyg_support/macros/textFormatSelector">
            Format box, if needed    
            </div>
    
         <div class="row"
              tal:define="error_file errors/file|nothing;"> 
                
                <div class="label">
                    <span i18n:translate="label_upload_contents_optional">Upload contents (optional)</span>
                    <div id="upload_help" 
                         i18n:translate="help_upload_text"
                         class="help" 
                         style="visibility:hidden">
                    This feature can be used if you already have the contents 
                    in an existing file on your computer and want to add 
                    it to this item.
                    
                    <br />&nbsp;<br />
                    
                    <strong>Please note that this takes precedence over the 
                    body text entered above, and all content in the field above
                    will be replaced with the contents of the file supplied here.
                    </strong>
                    </div>
                </div>
                
                <div class="field"
               tal:attributes="class python:test(error_file, 'field error', 'field')">
                      <div tal:replace="error_file" />
                      <input type="file" 
                             name="file" 
                             size="30" 
                             tabindex="" 
                             onfocus="formtooltip('upload_help',1)" 
                             onblur="formtooltip('upload_help',0)"
                             tal:attributes="tabindex tabindex/next;
                                             value python:here.getFilenameFromRequest('file')" 
                             />
                </div>
            </div>
        
        
            <div class="row">
                <div class="label">&nbsp;</div>
                <div class="field" tal:define="process_creation request/process_creation|nothing;"> 
                    <input class="context" 
                           tabindex=""
                           type="submit" 
                           name="Change" 
                           value="Save" 
                           i18n:attributes="value"
                           tal:attributes="tabindex tabindex/next;" /> 
                </div>
         </div>
            
            <input type="hidden" name="form_submitted" value="1" tal:attributes="value template/id" />
        </form>

    </div>

</body>
</html>
